% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/krcount.R
\name{krcount}
\alias{krcount}
\title{Quantify K-mers and UMI Data by Taxon}
\usage{
krcount(
  koutreads,
  kreport,
  umi_tag = NULL,
  barcode_tag = NULL,
  taxonomy = c("D__Bacteria", "D__Fungi", "D__Viruses"),
  batch_size = NULL,
  nqueue = NULL
)
}
\arguments{
\item{koutreads}{Path to the output file produced by \code{\link[=koutreads]{koutreads()}}.}

\item{kreport}{Path to the Kraken2 report file.}

\item{umi_tag}{(Optional) A string specifying the tag used to extract unique
molecular identifiers (UMIs) from each read. If \code{NULL}, all reads are counted
as total fragments.  Otherwise, only unique UMIs per (barcode, taxon) are
counted.}

\item{barcode_tag}{(Optional) A string specifying the tag used to extract the
cell barcode from each read. If \code{NULL}, all reads are assumed to originate
from a single cell.}

\item{taxonomy}{A character vector. The set of taxonomic groups to include
(default: \code{c("D__Bacteria", "D__Fungi", "D__Viruses")}). This defines the
global taxa to consider. Only the descendants within these groups will be
considered. If \code{NULL}, all taxa will be used.}

\item{nqueue}{Integer. Maximum number of buffers per thread, controlling the
amount of in-flight data awaiting writing. Default: \code{3}. Setting this too
high may increase memory consumption without performance gain.}
}
\description{
This function counts total and unique k-mers per taxon across cell barcodes,
using both the cell barcode and unique molecular identifier (UMI) to resolve
read identity at the single-cell level. It aggregates k-mer counts for each
taxonomic rank of interest (by default, genus and species), including all
descendant taxa within those ranks.
}
